Changes made to the Pipeline_server.R scipt before reproducing the pipeline with the og packages and setup


1. filter was assigned as variable
    -> renamed in filter_mask



2. frac_UnstableCells <- round(
  nrow(filter(so[[]], UnstableCells == TRUE)) / nrow(so[['UnstableCells']]), 3)

  -> nrow unstable cells can be NULL, fails

  replaced by: 
  so <- AssignUnstableCellFlag(so)
  frac_UnstableCells <- round(sum(so$UnstableCells) / nrow(so[[]]), 3)

3. packages needed: pryr, scDblFinder, philentropy, foreach, dofuture, leidenalg (not leiden), glmgampoi, for parallelizatin: doparallel, doRNG






Changes made when updating to seurat5

1. when using SCTransform() from seurat, the vst_out is not generated, so I used the 'manual' sct funcitons. 
  a.  sctransform::vst() (running the model) and save the result in so@assays$SCT@misc$vst.out for later
  b. make seurat assay for SCT and add the vst result to data (corr log expression)
  c. get the residuals and save them as scale.data in seurat object
  d. get the residual variance with sctransform::get_residual_var() and save it in VariableFeatures()

2. doublet detection
  a. in detect_doublets(so@assays$SCT@counts, so@meta.data$seurat_clusters) changed to so@assays$originalexp@counts because the new SCT version does not have counts saved in the counts slot


Ruined regnoise_pipeline_env by installing doparallel and doRNG -> new env is called regnoise_reproduce_env (og) and regnoise_reproduce_fast_env. new env for the fast version that needs doparallel and doRNG.
