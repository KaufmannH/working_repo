% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Wrappers.R
\name{prepare_matched_gene_sets}
\alias{prepare_matched_gene_sets}
\title{Prepare balanced HVG/LVG gene sets matched by mean expression}
\usage{
prepare_matched_gene_sets(
  input_file,
  hvg_perc_hvg = 0.9,
  lvg_res_var = 1,
  hvg_cutoff = 0.01,
  lvg_cutoff_low = 0.5,
  lvg_cutoff_high = 0.9,
  return_plots_and_tables = TRUE,
  seed = 1,
  tissue_filter = NULL
)
}
\arguments{
\item{input_file}{Path to the full_results_10_22.tsv file.}

\item{hvg_perc_hvg}{Minimum perc.hvg threshold to classify a gene as HVG.}

\item{lvg_res_var}{Maximum residual variance to classify a gene as LVG.}

\item{hvg_cutoff}{Minimum hvg_fraction to classify as potentially HVG.}

\item{lvg_cutoff_low}{Minimum lvg_fraction to classify as stable.}

\item{lvg_cutoff_high}{Maximum lvg_fraction to classify as potentially HVG.}

\item{return_plots_and_tables}{Logical; if TRUE, returns plots and tables in the output list.}

\item{seed}{Random seed for reproducible matching.}

\item{tissue_filter}{A character string of the tissue that should be filtered for.}
}
\value{
A list with elements:
  - gene_masterlist: tibble of all genes with classification
  - fraction_data: per-gene HVG/LVG/unclear fractions
  - prediction_data_matched: balanced HVG/LVG dataset
  - plots: list of ggplot objects (fraction, cutoff, gmean)
}
\description{
Reads the output table of the RegNoise pipeline and prepares two balanced
gene sets (highly variable vs stable genes) with matched median gmean values.
Returns intermediate data frames and plots as a list object, if specified.
}
